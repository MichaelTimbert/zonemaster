options {
        dnssec-validation auto;

        automatic-interface-scan no;
        #
        # Explicitly listen on specific addresses, both IPv4 and IPv6 to
        # prevent Bind to bind to too many addresses
        listen-on { 127.15.10.37; 127.15.10.38; 127.15.10.39; };
        listen-on-v6 { fda1:b2:c3:0:127:15:10:37; fda1:b2:c3:0:127:15:10:38; fda1:b2:c3:0:127:15:10:39; };
        #
        recursion no;
        notify no;
        empty-zones-enable no;
        pid-file "named.pid";
        masterfile-format text;
        session-keyfile none;
};

view "dnssec10-37" {

     match-destinations { 127.15.10.37; fda1:b2:c3:0:127:15:10:37; };
     key-directory "key-directory-37";

     zone "localhost" {
          type master;
          file "zones-37/localhost.zone";
     };

     zone "good-nsec-1.dnssec10.xa" {
          type master;
          file "zones-37/good-nsec-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec;
          inline-signing yes;
     };

     zone "good-nsec3-1.dnssec10.xa" {
          type master;
          file "zones-37/good-nsec3-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "algo-not-supp-by-zm-1.dnssec10.xa" {
          type master;
          file "zones-37/algo-not-supp-by-zm-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec;
          inline-signing yes;
     };

     zone "algo-not-supp-by-zm-2.dnssec10.xa" {
          type master;
          file "zones-37/algo-not-supp-by-zm-2.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "err-mult-nsec-1.dnssec10.xa" {
          type master;
          file "zones-37/err-mult-nsec-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec;
          inline-signing yes;
     };

     zone "err-mult-nsec3-1.dnssec10.xa" {
          type master;
          file "zones-37/err-mult-nsec3-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "exp-nsec-nsec3-miss-1.dnssec10.xa" {
          # The scenario has neither NSEC nor NSEC3, but we have to select
          # something to get the DNSKEY and RRSIG.
          type master;
          file "zones-37/exp-nsec-nsec3-miss-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec;
          inline-signing yes;
     };

     zone "inconsistent-nsec-1.dnssec10.xa" {
          type master;
          file "zones-37/inconsistent-nsec-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec;
          inline-signing yes;
     };

     zone "inconsistent-nsec3-1.dnssec10.xa" {
          type master;
          file "zones-37/inconsistent-nsec3-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "inconsist-nsec-nsec3-1.dnssec10.xa" {
          type master;
          file "zones-37/inconsist-nsec-nsec3-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec;
          inline-signing yes;
     };

     zone "inconsist-nsec-nsec3-2.dnssec10.xa" {
          type master;
          file "zones-37/inconsist-nsec-nsec3-2.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec;
          inline-signing yes;
     };

     zone "mixed-nsec-nsec3-1.dnssec10.xa" {
          type master;
          file "zones-37/mixed-nsec-nsec3-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec;
          inline-signing yes;
     };

     zone "mixed-nsec-nsec3-2.dnssec10.xa" {
          type master;
          file "zones-37/mixed-nsec-nsec3-2.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec;
          inline-signing yes;
     };

     zone "nsec3param-gives-err-answer-1.dnssec10.xa" {
          type master;
          file "zones-37/nsec3param-gives-err-answer-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3param-gives-err-answer-2.dnssec10.xa" {
          type master;
          file "zones-37/nsec3param-gives-err-answer-2.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3param-gives-err-answer-3.dnssec10.xa" {
          type master;
          file "zones-37/nsec3param-gives-err-answer-3.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3param-q-response-err-1.dnssec10.xa" {
          type master;
          file "zones-37/nsec3param-q-response-err-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3param-q-response-err-2.dnssec10.xa" {
          type master;
          file "zones-37/nsec3param-q-response-err-2.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3param-q-response-err-3.dnssec10.xa" {
          type master;
          file "zones-37/nsec3param-q-response-err-3.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3-err-type-list-1.dnssec10.xa" {
          type master;
          file "zones-37/nsec3-err-type-list-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3-err-type-list-2.dnssec10.xa" {
          type master;
          file "zones-37/nsec3-err-type-list-2.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3-mismatches-apex-1.dnssec10.xa" {
          type master;
          file "zones-37/nsec3-mismatches-apex-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3-missing-signature-1.dnssec10.xa" {
          type master;
          file "zones-37/nsec3-missing-signature-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3-nodata-missing-soa-1.dnssec10.xa" {
          type master;
          file "zones-37/nsec3-nodata-missing-soa-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3-nodata-wrong-soa-1.dnssec10.xa" {
          type master;
          file "zones-37/nsec3-nodata-wrong-soa-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3-no-verified-signature-1.dnssec10.xa" {
          type master;
          file "zones-37/nsec3-no-verified-signature-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3-no-verified-signature-2.dnssec10.xa" {
          type master;
          file "zones-37/nsec3-no-verified-signature-2.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3-no-verified-signature-3.dnssec10.xa" {
          type master;
          file "zones-37/nsec3-no-verified-signature-3.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "nsec3-no-verified-signature-4.dnssec10.xa" {
          type master;
          file "zones-37/nsec3-no-verified-signature-4.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };


}; # End view dnssec10-37


view "dnssec10-38" {

     match-destinations { 127.15.10.38; fda1:b2:c3:0:127:15:10:38; };
     key-directory "key-directory-38";

     zone "localhost" {
          type master;
          file "zones-38/localhost.zone";
     };

     zone "inconsist-nsec-nsec3-1.dnssec10.xa" {
          type master;
          file "zones-38/inconsist-nsec-nsec3-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "inconsist-nsec-nsec3-2.dnssec10.xa" {
          type master;
          file "zones-38/inconsist-nsec-nsec3-2.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "mixed-nsec-nsec3-1.dnssec10.xa" {
          type master;
          file "zones-38/mixed-nsec-nsec3-1.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

     zone "mixed-nsec-nsec3-2.dnssec10.xa" {
          type master;
          file "zones-38/mixed-nsec-nsec3-2.dnssec10.xa.zone";
          dnssec-policy dnssec10-nsec3;
          inline-signing yes;
     };

}; # End view dnssec10-38


view "dnssec10-39" {

     match-destinations { 127.15.10.39; fda1:b2:c3:0:127:15:10:39; };
     key-directory "key-directory-39";

     zone "localhost" {
          type master;
          file "zones-39/localhost.zone";
     };

}; # End view dnssec10-39


## DNSSEC policy
# Period duration definition: https://en.wikipedia.org/wiki/ISO_8601#Durations
dnssec-policy dnssec10-nsec3 {
      dnskey-ttl                 PT24H;
      keys {
          ksk lifetime unlimited algorithm 13; # ECDSAP256SHA256
          zsk lifetime unlimited algorithm 13; # ECDSAP256SHA256
      };
      max-zone-ttl               P7W;
      nsec3param   iterations 0 optout no salt-length 0;
      signatures-validity        P8Y;
      signatures-validity-dnskey P8Y;
};
dnssec-policy dnssec10-nsec {
      dnskey-ttl                 PT24H;
      keys {
          ksk lifetime unlimited algorithm 13; # ECDSAP256SHA256
          zsk lifetime unlimited algorithm 13; # ECDSAP256SHA256
      };
      max-zone-ttl               PT24H;
      signatures-validity        P8Y;
      signatures-validity-dnskey P8Y;
};

